# 基本概念

LVM 全称是 Logical Volume Manager，也就是逻辑卷管理。它是在 Linux 分区的基础上创建了一个逻辑层，**可以灵活方便的去管理存储设备。**

LVM 利用的是 Linux 系统的 device-mapper 功能来实现存储系统的虚拟化，**也就是系统分区独立于底层的硬件。**通过 LVM 可以实现物理磁盘的抽象化，并且在上面建立虚拟分区。同时可以进行在线的变更。

## 基本组成部分

### 物理卷 PV

物理卷 PV 的全称是 Physical Volume。它是一个**可供存储LVM块的设备**。比如：

- 硬盘分区
- 回环设备
- SAN
- Raid 硬盘
- LUN
- 或者一个被内核映射的设备，比如 dm-encrypt

它包含了一个特殊的 LVM 头，同时也是构建 LVM 系统的基础部分和实际硬件。

### 卷组 VG

卷组 VG 的全称是 Volume Group。它是一个**对一个或多个物理卷的集合**。在文件系统中显示为`/dev/vg_name`

### 逻辑卷 LV

逻辑卷 LV 的全称是 Logical Volume。它是**可供系统使用的最终元设备**。它们被卷组管理，同时也由卷组去创建。**由物理块构成，但本质上是虚拟分区。**可以在上面创建文件系统，在文件系统中显示为`/dev/vg_name/lv_name`

### 物理块 PE

物理块 PE 的全称是 Physical Extends。**它是一个卷组中最小的连续区域（默认为4 MiB）**，多个物理块将被分配给一个逻辑卷。你可以把它看成物理卷的一部分，这部分可以被分配给一个逻辑卷。

### 关系图

![img](https://i-blog.csdnimg.cn/blog_migrate/cc27afedeb747c36f557e7ef83e6cc5a.png)

顺序依次为：Disk -> Partition -> PV -> VG -> LV -> Filesystem，也即磁盘->分区->物理卷->卷组->逻辑卷->文件系统。

# 优缺点

## 优点

- 多块硬盘看作一块大硬盘

- 使用逻辑卷（LV），可以创建跨越众多硬盘空间的分区。

- 可以创建小的逻辑卷（LV），在空间不足时再动态调整它的大小。

- 在调整逻辑卷（LV）大小时可以不用考虑逻辑卷在硬盘上的位置，不用担心没有可用的连续空间。

- 可以在线（Online）对逻辑卷（LV）和卷组（VG）进行创建、删除、调整大小等操作。不过LVM上的文件系统也需要重新调整大小，好在某些文件系统（例如ext4）也支持在线操作。

- 无需重新启动服务，就可以将服务中用到的逻辑卷（LV）在线（online）/动态（live）迁移至别的硬盘上。

- 允许创建快照，可以保存文件系统的备份，同时使服务的下线时间（downtime）降低到最小。

- 支持各种设备映射目标（device-mapper targets），包括透明文件系统加密和缓存常用数据（caching of frequently used  data）。这将允许你创建一个包含一个或多个磁盘、并用LUKS加密的系统，使用LVM on top 可轻松地管理和调整这些独立的加密卷 （例如. /, /home, /backup等) 并免去开机时多次输入密钥的麻烦。

## 缺点

- Windows 系统不支持 LVM 
- 系统恢复可能会遇到问题 
